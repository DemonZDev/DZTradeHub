name: ğŸ—ï¸ Build DZTradeHub

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  build:
    name: ğŸš€ Build Plugin on Ubuntu 24.04
    runs-on: ubuntu-24.04
    
    steps:
      # ============================================
      # ğŸ“¦ SETUP PHASE
      # ============================================
      
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4
      
      - name: ğŸ”§ Install SDKMAN!
        run: |
          echo "ğŸ“¦ Installing SDKMAN!..."
          curl -s "https://get.sdkman.io" | bash
          source "$HOME/.sdkman/bin/sdkman-init.sh"
          echo "âœ… SDKMAN! Version:"
          sdk version
      
      # ============================================
      # â˜• JAVA & MAVEN INSTALLATION
      # ============================================
      
      - name: â˜• Install Java 21 (Oracle)
        run: |
          source "$HOME/.sdkman/bin/sdkman-init.sh"
          echo "ğŸ“¦ Installing Oracle Java 21..."
          sdk install java 21-oracle
          sdk default java 21-oracle
          echo "âœ… Java Version:"
          java -version
      
      - name: ğŸ“¦ Install Maven 3.9.11
        run: |
          source "$HOME/.sdkman/bin/sdkman-init.sh"
          echo "ğŸ“¦ Installing Maven 3.9.11..."
          sdk install maven 3.9.11
          sdk default maven 3.9.11
          echo "âœ… Maven Version:"
          mvn -version
      
      # ============================================
      # ğŸ› ï¸ BUILD PHASE
      # ============================================
      
      - name: ğŸ› ï¸ Build DZTradeHub Plugin
        run: |
          source "$HOME/.sdkman/bin/sdkman-init.sh"
          echo "ğŸ”¨ Starting Maven build..."
          mvn clean package -DskipTests
          echo "âœ… Build completed successfully!"
      
      # ============================================
      # ğŸ“¤ ARTIFACT UPLOAD
      # ============================================
      
      - name: ğŸ“¤ Upload Plugin JAR
        uses: actions/upload-artifact@v4
        with:
          name: DZTradeHub-1.0.0.jar
          path: target/DZTradeHub-1.0.0.jar
          compression-level: 0
          if-no-files-found: error
      
      - name: ğŸ‰ Build Summary
        run: |
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âœ… DZTradeHub v1.0.0 Build Complete!"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ“¦ Java: Oracle JDK 21"
          echo "ğŸ”§ Maven: 3.9.11"
          echo "ğŸ–¥ï¸  OS: Ubuntu 24.04"
          echo "ğŸ“ Artifact: DZTradeHub-v1.0.0.jar"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
